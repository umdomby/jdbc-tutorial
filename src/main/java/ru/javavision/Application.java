package ru.javavision;

/**
 * Author : Pavel Ravvich.
 * Created : 02/11/2017.
 */
public class Application {
    public static void main(String[] args) {

        PhoneDAO phoneDAO = null;

        try {
            phoneDAO = new PhoneDAOImpl("postgres", "1", "jdbc:postgresql://localhost:5432/phones-magazine");

            StatisticRepository dao =  new StatisticRepositoryImpl("postgres", "1", "jdbc:postgresql://localhost:5432/phones_magazine");

            final PhoneModel model = new PhoneModel();
            model.setName("samsung");
            List<PhoneModel> models = new ArrayList<>();
            models.add(model);
            dao.getStat(
                    models,
                    new Statistic.TimeRange(
                            new Timestamp(System.currentTimeMillis() - 31536000000L),
                            new Timestamp(System.currentTimeMillis())),
                    Comparator.comparing(Statistic::getRevenue)
                    ).forEach(System.out::println);

        } catch (SQLException e) {
            e.printStackTrace();
        } finally {
            assert phoneDAO != null;
            phoneDAO.closeConnection();
        }
//    }

}
